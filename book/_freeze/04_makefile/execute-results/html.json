{
  "hash": "7e824f8770d64045fe0b22efa0eab9f7",
  "result": {
    "engine": "jupyter",
    "markdown": "# 04_makefile.qmd\n\n---\ntitle: \"04 — Makefile\"\nformat: html\nexecute:\n  echo: true\n---\n\nIntroduction — This Makefile provides convenient targets for common development tasks: showing help, creating the environment, generating data, building a small local DB, producing feature files, rendering the Quarto book, running tests, and cleaning generated artifacts. Explanations below cover Makefile syntax and the behavior of each target.\n\n```{makefile}\n.DEFAULT_GOAL := help\n\n.PHONY: help env data db features book test clean\n\nhelp:\n\t@echo \"Available targets:\"\n\t@echo \"  env       Create virtualenv and install Python dependencies\"\n\t@echo \"  data      Generate raw/synthetic data (runs scripts/make_synth_data.py)\"\n\t@echo \"  db        Create/populate sqlite DB (runs scripts/make_sqlite.py)\"\n\t@echo \"  features  Build feature files (runs scripts/build_features.py)\"\n\t@echo \"  book      Render the Quarto book (quarto render book)\"\n\t@echo \"  test      Run pytest\"\n\t@echo \"  clean     Remove build artifacts and generated data\"\n```\n\nExplanation for the above code:\n- `.DEFAULT_GOAL := help` sets the default target that runs when no target is specified; here it shows the help text.\n- `.PHONY: ...` declares phony targets that are not file names; this prevents conflicts if a file with the same name exists and ensures the recipes always run.\n- `help:` defines a target whose recipe prints the list of available targets. Each `@echo` prints a line; the leading `@` suppresses echoing the command itself, so only the text is shown when `make` runs.\n\n```{makefile}\nenv:\n\tpip install -r requirements.txt\ndata:\n\tpython scripts/make_synth_data.py\ndb:\n\tpython scripts/make_sqlite.py\nfeatures:\n\tpython scripts/build_features.py\nbook:\n\tquarto render book\ntest:\n\tpytest -q\n```\n\nExplanation for the above code:\n- `env:` runs `pip install -r requirements.txt` to install Python dependencies. On systems where a virtual environment is preferred, create/activate the venv before calling this target or modify the recipe to create one.\n- `data:` runs the Python data-generation script `scripts/make_synth_data.py` to populate `data/raw/`.\n- `db:` runs `scripts/make_sqlite.py` to create/populate a local SQLite database (if that script exists).\n- `features:` runs `scripts/build_features.py` to create processed feature files (e.g., `data/processed/`).\n- `book:` runs `quarto render book` to render the Quarto project into the `book/` output.\n- `test:` runs `pytest -q` to execute the test suite; `-q` makes pytest quieter in its output.\n\n```{makefile}\nclean:\nclean:\n\tdel /Q db\\*.db\n\tdel /Q data\\processed\\*\n\trmdir /S /Q book\\_freeze\n```\n\nExplanation for the above code:\n- The `clean` target is intended to remove generated artifacts. In this Makefile the `clean` target appears twice (an empty definition followed by the recipe). Duplicate target definitions can be confusing — combine into a single `clean:` definition with its recipe for clarity.\n- The commands shown use Windows `cmd`/PowerShell syntax:\n  - `del /Q db\\*.db` deletes `.db` files quietly.\n  - `del /Q data\\processed\\*` deletes files in `data\\processed`.\n  - `rmdir /S /Q book\\_freeze` removes the `book_freeze` directory and its contents quietly.\n- Portability notes:\n  - `del` and `rmdir` are Windows commands and will not work in a Unix shell. If you run this Makefile under a Unix-like shell (bash, zsh, CI runners), replace these with portable Unix equivalents (for example `rm -f db/*.db` and `rm -rf data/processed/* book/_freeze`) or add conditional logic in the Makefile to detect the platform.\n  - Recipes in Makefiles must be indented with a **tab** character, not spaces. Ensure your editor preserves tabs for recipe lines.\n- Suggestion: consolidate the duplicate `clean` target into one, and consider adding a cross-platform `clean` recipe or two separate targets (e.g., `clean-windows` and `clean-unix`) to avoid accidental failures on different systems.\n\n",
    "supporting": [
      "04_makefile_files"
    ],
    "filters": [],
    "includes": {}
  }
}